<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>log_manager API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>log_manager</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import os
from log import Log
from packet import create_child_pkt
from packet import create_contn_pkt
from packet import create_end_pkt
from packet import create_parent_pkt
from ssb_util import from_hex
from ssb_util import is_file
from ssb_util import to_hex


class LogManager:
    &#34;&#34;&#34;
    Manages and creates Log instances.
    The path can be specified in the constructor with path=&#34;path&#34;
    (TODO: test).
    &#34;&#34;&#34;

    def __init__(self, path: str = &#34;&#34;):
        self.path = path
        self.log_dir = self.path + &#34;_logs&#34;
        self.blob_dir = self.path + &#34;_blobs&#34;
        self._check_dirs()
        self.logs = self._get_logs()

    def __len__(self):
        return len(self.logs)

    def __getitem__(self, i: int) -&gt; Log:
        return self.logs[i]

    def _check_dirs(self):
        &#34;&#34;&#34;
        Checks whether the _log and _blob firectories already exist.
        If not, new directories are created.
        &#34;&#34;&#34;
        if not is_file(self.log_dir):
            os.mkdir(self.log_dir)
        if not is_file(self.blob_dir):
            os.mkdir(self.blob_dir)

    def _get_logs(self) -&gt; [Log]:
        &#34;&#34;&#34;
        Reads all .log files in the self.log_dir directory.
        Returns a list of all Log instances.
        &#34;&#34;&#34;
        logs = []
        files = os.listdir(self.log_dir)
        for f in files:
            if f.endswith(&#34;.log&#34;):
                logs.append(Log(self.log_dir + &#34;/&#34; + f))

        return logs

    def get_log(self, fid: bytes) -&gt; Log:
        &#34;&#34;&#34;
        Searches for a specific Log in self.logs.
        The feed ID can be handed in as bytes, a hex string
        or a file name.
        Retruns &#39;None&#39; if the log cannot be found.
        &#34;&#34;&#34;
        # transform to bytes
        if type(fid) is str:
            if fid.endswith(&#34;.log&#34;):
                fid = fid[:-4]
            fid = from_hex(fid)

        # search
        for log in self.logs:
            if log.fid == fid:
                return log

        return None

    def create_new_log(self,
                       fid: bytes = None,
                       trusted_seq: int = 0,
                       trusted_mid: bytes = None,
                       parent_seq: int = 0,
                       parent_fid: bytes = bytes(32)) -&gt; Log:
        &#34;&#34;&#34;
        Creates a new Log instance and adds it to self.logs.
        The feed ID, trusted sequence number, trusted message ID,
        parent feed ID and parent sequence number can be explicitly
        specified.
        If no feed ID is specified, a random one is generated.
        Returns the newly created Log instance.
        &#34;&#34;&#34;
        if fid is None:
            fid = os.urandom(32)

        if trusted_mid is None:
            trusted_mid = fid[:20]  # tinyssb convention, self-signed

        trusted_seq = trusted_seq.to_bytes(4, &#34;big&#34;)
        parent_seq = parent_seq.to_bytes(4, &#34;big&#34;)

        assert len(fid) == 32, &#34;fid must be 32b&#34;
        assert len(trusted_seq) == 4, &#34;trusted seq must be 4b&#34;
        assert len(trusted_mid) == 20, &#34;trusted mid must be 20b&#34;
        assert len(parent_seq) == 4, &#34;parent seq must be 4b&#34;
        assert len(parent_fid) == 32, &#34;parent_fid must be 32b&#34;

        # create log file
        file_name = self.log_dir + &#34;/&#34; + to_hex(fid) + &#34;.log&#34;
        if os.path.isfile(file_name):
            return None

        header = bytes(12) + fid + parent_fid + parent_seq
        header += trusted_seq + trusted_mid
        header += trusted_seq + fid[:20]  # self-signed

        assert len(header) == 128, f&#34;header must be 128b, was {len(header)}&#34;

        # create new log file
        with open(file_name, &#34;wb&#34;) as f:
            f.write(header)

        log = Log(file_name)
        self.logs.append(log)
        return log

    def create_child_log(self, parent_fid: bytes,
                         child_fid: bytes = None) -&gt; Log:
        &#34;&#34;&#34;
        Creates and returns a new child Log instance for the given parent.
        The parent can be passed either as a Log instance, feed ID bytes,
        feed ID hex string or file name.
        The child feed ID can be explicitly definied.
        &#34;&#34;&#34;
        if type(parent_fid) is Log:
            parent = parent_fid
        else:
            parent = self.get_log(parent_fid)

        if parent is None:
            return None

        if child_fid is None:
            child_fid = os.urandom(32)

        # add child info to parent
        parent_seq = (parent.front_seq + 1).to_bytes(4, &#34;big&#34;)
        parent_pkt = create_parent_pkt(parent.fid, parent_seq,
                                       parent.front_mid, child_fid)
        parent.append_pkt(parent_pkt)

        # create child log
        child_payload = parent_pkt.fid + parent_pkt.seq
        child_payload += parent_pkt.wire[-12:]
        child_log = self.create_new_log(child_fid,
                                        parent_fid=parent.fid,
                                        parent_seq=parent.front_seq)

        child_pkt = create_child_pkt(child_log.fid, child_payload)
        child_log.append_pkt(child_pkt)
        return child_log

    def create_contn_log(self, end_fid: bytes,
                         contn_fid: bytes = None) -&gt; Log:
        &#34;&#34;&#34;
        Ends the given log and returns a new continuation Log instance.
        The ending log can be passed either as a Log instance, feed ID bytes,
        feed ID hex string or file name.
        The continuation feed ID can be explicitly defined.
        &#34;&#34;&#34;
        if type(end_fid) is Log:
            ending_log = end_fid
        else:
            ending_log = self.get_log(end_fid)

        if ending_log is None:
            return None

        if contn_fid is None:
            contn_fid = os.urandom(32)

        end_seq = (ending_log.front_seq + 1).to_bytes(4, &#34;big&#34;)
        end_pkt = create_end_pkt(ending_log.fid, end_seq,
                                 ending_log.front_mid, contn_fid)

        ending_log.append_pkt(end_pkt)
        # create continuing log
        contn_payload = end_pkt.fid + end_pkt.seq
        contn_payload += end_pkt.wire[-12:]
        contn_log = self.create_new_log(contn_fid,
                                        parent_fid=ending_log.fid,
                                        parent_seq=ending_log.front_seq)

        contn_pkt = create_contn_pkt(contn_log.fid, contn_payload)
        contn_log.append(contn_pkt)
        return contn_log</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="log_manager.LogManager"><code class="flex name class">
<span>class <span class="ident">LogManager</span></span>
<span>(</span><span>path: str = '')</span>
</code></dt>
<dd>
<div class="desc"><p>Manages and creates Log instances.
The path can be specified in the constructor with path="path"
(TODO: test).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LogManager:
    &#34;&#34;&#34;
    Manages and creates Log instances.
    The path can be specified in the constructor with path=&#34;path&#34;
    (TODO: test).
    &#34;&#34;&#34;

    def __init__(self, path: str = &#34;&#34;):
        self.path = path
        self.log_dir = self.path + &#34;_logs&#34;
        self.blob_dir = self.path + &#34;_blobs&#34;
        self._check_dirs()
        self.logs = self._get_logs()

    def __len__(self):
        return len(self.logs)

    def __getitem__(self, i: int) -&gt; Log:
        return self.logs[i]

    def _check_dirs(self):
        &#34;&#34;&#34;
        Checks whether the _log and _blob firectories already exist.
        If not, new directories are created.
        &#34;&#34;&#34;
        if not is_file(self.log_dir):
            os.mkdir(self.log_dir)
        if not is_file(self.blob_dir):
            os.mkdir(self.blob_dir)

    def _get_logs(self) -&gt; [Log]:
        &#34;&#34;&#34;
        Reads all .log files in the self.log_dir directory.
        Returns a list of all Log instances.
        &#34;&#34;&#34;
        logs = []
        files = os.listdir(self.log_dir)
        for f in files:
            if f.endswith(&#34;.log&#34;):
                logs.append(Log(self.log_dir + &#34;/&#34; + f))

        return logs

    def get_log(self, fid: bytes) -&gt; Log:
        &#34;&#34;&#34;
        Searches for a specific Log in self.logs.
        The feed ID can be handed in as bytes, a hex string
        or a file name.
        Retruns &#39;None&#39; if the log cannot be found.
        &#34;&#34;&#34;
        # transform to bytes
        if type(fid) is str:
            if fid.endswith(&#34;.log&#34;):
                fid = fid[:-4]
            fid = from_hex(fid)

        # search
        for log in self.logs:
            if log.fid == fid:
                return log

        return None

    def create_new_log(self,
                       fid: bytes = None,
                       trusted_seq: int = 0,
                       trusted_mid: bytes = None,
                       parent_seq: int = 0,
                       parent_fid: bytes = bytes(32)) -&gt; Log:
        &#34;&#34;&#34;
        Creates a new Log instance and adds it to self.logs.
        The feed ID, trusted sequence number, trusted message ID,
        parent feed ID and parent sequence number can be explicitly
        specified.
        If no feed ID is specified, a random one is generated.
        Returns the newly created Log instance.
        &#34;&#34;&#34;
        if fid is None:
            fid = os.urandom(32)

        if trusted_mid is None:
            trusted_mid = fid[:20]  # tinyssb convention, self-signed

        trusted_seq = trusted_seq.to_bytes(4, &#34;big&#34;)
        parent_seq = parent_seq.to_bytes(4, &#34;big&#34;)

        assert len(fid) == 32, &#34;fid must be 32b&#34;
        assert len(trusted_seq) == 4, &#34;trusted seq must be 4b&#34;
        assert len(trusted_mid) == 20, &#34;trusted mid must be 20b&#34;
        assert len(parent_seq) == 4, &#34;parent seq must be 4b&#34;
        assert len(parent_fid) == 32, &#34;parent_fid must be 32b&#34;

        # create log file
        file_name = self.log_dir + &#34;/&#34; + to_hex(fid) + &#34;.log&#34;
        if os.path.isfile(file_name):
            return None

        header = bytes(12) + fid + parent_fid + parent_seq
        header += trusted_seq + trusted_mid
        header += trusted_seq + fid[:20]  # self-signed

        assert len(header) == 128, f&#34;header must be 128b, was {len(header)}&#34;

        # create new log file
        with open(file_name, &#34;wb&#34;) as f:
            f.write(header)

        log = Log(file_name)
        self.logs.append(log)
        return log

    def create_child_log(self, parent_fid: bytes,
                         child_fid: bytes = None) -&gt; Log:
        &#34;&#34;&#34;
        Creates and returns a new child Log instance for the given parent.
        The parent can be passed either as a Log instance, feed ID bytes,
        feed ID hex string or file name.
        The child feed ID can be explicitly definied.
        &#34;&#34;&#34;
        if type(parent_fid) is Log:
            parent = parent_fid
        else:
            parent = self.get_log(parent_fid)

        if parent is None:
            return None

        if child_fid is None:
            child_fid = os.urandom(32)

        # add child info to parent
        parent_seq = (parent.front_seq + 1).to_bytes(4, &#34;big&#34;)
        parent_pkt = create_parent_pkt(parent.fid, parent_seq,
                                       parent.front_mid, child_fid)
        parent.append_pkt(parent_pkt)

        # create child log
        child_payload = parent_pkt.fid + parent_pkt.seq
        child_payload += parent_pkt.wire[-12:]
        child_log = self.create_new_log(child_fid,
                                        parent_fid=parent.fid,
                                        parent_seq=parent.front_seq)

        child_pkt = create_child_pkt(child_log.fid, child_payload)
        child_log.append_pkt(child_pkt)
        return child_log

    def create_contn_log(self, end_fid: bytes,
                         contn_fid: bytes = None) -&gt; Log:
        &#34;&#34;&#34;
        Ends the given log and returns a new continuation Log instance.
        The ending log can be passed either as a Log instance, feed ID bytes,
        feed ID hex string or file name.
        The continuation feed ID can be explicitly defined.
        &#34;&#34;&#34;
        if type(end_fid) is Log:
            ending_log = end_fid
        else:
            ending_log = self.get_log(end_fid)

        if ending_log is None:
            return None

        if contn_fid is None:
            contn_fid = os.urandom(32)

        end_seq = (ending_log.front_seq + 1).to_bytes(4, &#34;big&#34;)
        end_pkt = create_end_pkt(ending_log.fid, end_seq,
                                 ending_log.front_mid, contn_fid)

        ending_log.append_pkt(end_pkt)
        # create continuing log
        contn_payload = end_pkt.fid + end_pkt.seq
        contn_payload += end_pkt.wire[-12:]
        contn_log = self.create_new_log(contn_fid,
                                        parent_fid=ending_log.fid,
                                        parent_seq=ending_log.front_seq)

        contn_pkt = create_contn_pkt(contn_log.fid, contn_payload)
        contn_log.append(contn_pkt)
        return contn_log</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="log_manager.LogManager.create_child_log"><code class="name flex">
<span>def <span class="ident">create_child_log</span></span>(<span>self, parent_fid: bytes, child_fid: bytes = None) ‑> log.Log</span>
</code></dt>
<dd>
<div class="desc"><p>Creates and returns a new child Log instance for the given parent.
The parent can be passed either as a Log instance, feed ID bytes,
feed ID hex string or file name.
The child feed ID can be explicitly definied.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_child_log(self, parent_fid: bytes,
                     child_fid: bytes = None) -&gt; Log:
    &#34;&#34;&#34;
    Creates and returns a new child Log instance for the given parent.
    The parent can be passed either as a Log instance, feed ID bytes,
    feed ID hex string or file name.
    The child feed ID can be explicitly definied.
    &#34;&#34;&#34;
    if type(parent_fid) is Log:
        parent = parent_fid
    else:
        parent = self.get_log(parent_fid)

    if parent is None:
        return None

    if child_fid is None:
        child_fid = os.urandom(32)

    # add child info to parent
    parent_seq = (parent.front_seq + 1).to_bytes(4, &#34;big&#34;)
    parent_pkt = create_parent_pkt(parent.fid, parent_seq,
                                   parent.front_mid, child_fid)
    parent.append_pkt(parent_pkt)

    # create child log
    child_payload = parent_pkt.fid + parent_pkt.seq
    child_payload += parent_pkt.wire[-12:]
    child_log = self.create_new_log(child_fid,
                                    parent_fid=parent.fid,
                                    parent_seq=parent.front_seq)

    child_pkt = create_child_pkt(child_log.fid, child_payload)
    child_log.append_pkt(child_pkt)
    return child_log</code></pre>
</details>
</dd>
<dt id="log_manager.LogManager.create_contn_log"><code class="name flex">
<span>def <span class="ident">create_contn_log</span></span>(<span>self, end_fid: bytes, contn_fid: bytes = None) ‑> log.Log</span>
</code></dt>
<dd>
<div class="desc"><p>Ends the given log and returns a new continuation Log instance.
The ending log can be passed either as a Log instance, feed ID bytes,
feed ID hex string or file name.
The continuation feed ID can be explicitly defined.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_contn_log(self, end_fid: bytes,
                     contn_fid: bytes = None) -&gt; Log:
    &#34;&#34;&#34;
    Ends the given log and returns a new continuation Log instance.
    The ending log can be passed either as a Log instance, feed ID bytes,
    feed ID hex string or file name.
    The continuation feed ID can be explicitly defined.
    &#34;&#34;&#34;
    if type(end_fid) is Log:
        ending_log = end_fid
    else:
        ending_log = self.get_log(end_fid)

    if ending_log is None:
        return None

    if contn_fid is None:
        contn_fid = os.urandom(32)

    end_seq = (ending_log.front_seq + 1).to_bytes(4, &#34;big&#34;)
    end_pkt = create_end_pkt(ending_log.fid, end_seq,
                             ending_log.front_mid, contn_fid)

    ending_log.append_pkt(end_pkt)
    # create continuing log
    contn_payload = end_pkt.fid + end_pkt.seq
    contn_payload += end_pkt.wire[-12:]
    contn_log = self.create_new_log(contn_fid,
                                    parent_fid=ending_log.fid,
                                    parent_seq=ending_log.front_seq)

    contn_pkt = create_contn_pkt(contn_log.fid, contn_payload)
    contn_log.append(contn_pkt)
    return contn_log</code></pre>
</details>
</dd>
<dt id="log_manager.LogManager.create_new_log"><code class="name flex">
<span>def <span class="ident">create_new_log</span></span>(<span>self, fid: bytes = None, trusted_seq: int = 0, trusted_mid: bytes = None, parent_seq: int = 0, parent_fid: bytes = b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00') ‑> log.Log</span>
</code></dt>
<dd>
<div class="desc"><p>Creates a new Log instance and adds it to self.logs.
The feed ID, trusted sequence number, trusted message ID,
parent feed ID and parent sequence number can be explicitly
specified.
If no feed ID is specified, a random one is generated.
Returns the newly created Log instance.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_new_log(self,
                   fid: bytes = None,
                   trusted_seq: int = 0,
                   trusted_mid: bytes = None,
                   parent_seq: int = 0,
                   parent_fid: bytes = bytes(32)) -&gt; Log:
    &#34;&#34;&#34;
    Creates a new Log instance and adds it to self.logs.
    The feed ID, trusted sequence number, trusted message ID,
    parent feed ID and parent sequence number can be explicitly
    specified.
    If no feed ID is specified, a random one is generated.
    Returns the newly created Log instance.
    &#34;&#34;&#34;
    if fid is None:
        fid = os.urandom(32)

    if trusted_mid is None:
        trusted_mid = fid[:20]  # tinyssb convention, self-signed

    trusted_seq = trusted_seq.to_bytes(4, &#34;big&#34;)
    parent_seq = parent_seq.to_bytes(4, &#34;big&#34;)

    assert len(fid) == 32, &#34;fid must be 32b&#34;
    assert len(trusted_seq) == 4, &#34;trusted seq must be 4b&#34;
    assert len(trusted_mid) == 20, &#34;trusted mid must be 20b&#34;
    assert len(parent_seq) == 4, &#34;parent seq must be 4b&#34;
    assert len(parent_fid) == 32, &#34;parent_fid must be 32b&#34;

    # create log file
    file_name = self.log_dir + &#34;/&#34; + to_hex(fid) + &#34;.log&#34;
    if os.path.isfile(file_name):
        return None

    header = bytes(12) + fid + parent_fid + parent_seq
    header += trusted_seq + trusted_mid
    header += trusted_seq + fid[:20]  # self-signed

    assert len(header) == 128, f&#34;header must be 128b, was {len(header)}&#34;

    # create new log file
    with open(file_name, &#34;wb&#34;) as f:
        f.write(header)

    log = Log(file_name)
    self.logs.append(log)
    return log</code></pre>
</details>
</dd>
<dt id="log_manager.LogManager.get_log"><code class="name flex">
<span>def <span class="ident">get_log</span></span>(<span>self, fid: bytes) ‑> log.Log</span>
</code></dt>
<dd>
<div class="desc"><p>Searches for a specific Log in self.logs.
The feed ID can be handed in as bytes, a hex string
or a file name.
Retruns 'None' if the log cannot be found.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_log(self, fid: bytes) -&gt; Log:
    &#34;&#34;&#34;
    Searches for a specific Log in self.logs.
    The feed ID can be handed in as bytes, a hex string
    or a file name.
    Retruns &#39;None&#39; if the log cannot be found.
    &#34;&#34;&#34;
    # transform to bytes
    if type(fid) is str:
        if fid.endswith(&#34;.log&#34;):
            fid = fid[:-4]
        fid = from_hex(fid)

    # search
    for log in self.logs:
        if log.fid == fid:
            return log

    return None</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="log_manager.LogManager" href="#log_manager.LogManager">LogManager</a></code></h4>
<ul class="">
<li><code><a title="log_manager.LogManager.create_child_log" href="#log_manager.LogManager.create_child_log">create_child_log</a></code></li>
<li><code><a title="log_manager.LogManager.create_contn_log" href="#log_manager.LogManager.create_contn_log">create_contn_log</a></code></li>
<li><code><a title="log_manager.LogManager.create_new_log" href="#log_manager.LogManager.create_new_log">create_new_log</a></code></li>
<li><code><a title="log_manager.LogManager.get_log" href="#log_manager.LogManager.get_log">get_log</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>